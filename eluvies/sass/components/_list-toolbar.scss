@use '../../../core/sass/abstracts/variables' as core;
@use '../abstracts/variables' as *;
@use 'sass:math';

.status-menu-container,
.list-unit .list-status-title {
    display: flex;
    height: $list-toolbar-height;
}   

.status-menu-container .search-container,
.list-unit .list-status-title .stats {
    height: 100%;
}

// List toolbar | Status menu

.status-menu-container {
    position: relative;
    z-index: 2;
    width: 100%;
    background-color: #222222;
    max-width: $content-max-width;
    display: flex;
    padding: 0 $page-padding;
}

.status-menu-container.fixed {
    position: fixed;
    top: $header-height;
    left: 0;
    right: 0;
    margin: 0 auto;
}

.status-menu-container .status-menu {
    background-color: rgb(47, 47, 47);
    height: 0;
    overflow: hidden;
    border-radius: $border-radius-1;
    margin-top: $list-toolbar-height;
    transition: all 0.5s ease-in-out;
    width: fit-content;
    
    &:before,
    &:after {
        content: var(--current-status);
        color: $text-color;
        top: calc(($list-toolbar-height - 1lh) / 2);
        position: absolute;
        cursor: pointer;
        padding-right: calc(core.$icon-size * core.$icon-chevron-down-ratio + $icon-text-gap); 
    }
    
    &:has(.all_anime.on) {
        --current-status: "All Anime";
    }

    &:has(.watching.on) {
        --current-status: "Currently Watching";
    }

    &:has(.completed.on) {
        --current-status: "Completed";
    }

    &:has(.onhold.on) {
        --current-status: "On Hold";
    }

    &:has(.dropped.on) {
        --current-status: "Dropped";
    }

    &:has(.plantowatch.on) {
        --current-status: "Plan to Watch";
    }

    &:after {
        background-color: currentColor;
        mask-image: core.$icon-chevron-down-url;
        mask-repeat: no-repeat;
        mask-position: right center;
        mask-size: auto core.$icon-size;
    }

    &:hover:not(:has(.search-container:hover)) {
        &:before,
        &:after {
            --text-color: rgba(255, 255, 255, .5);
        }
        
        &:before{
            height: calc(($list-toolbar-height + 1lh) / 2);
        }
    }
    
    // Search

    .search-container {
        position: absolute;
        top: 0;
        right: 0;
        display: flex;

        #search-box {
            display: none
        }

        &:after {
            content: 'FiltersStats';
            padding-right:  calc(23 / 16 * core.$icon-size + 2 * $icon-text-gap + 4 * $page-padding);
            visibility: hidden;
        }
    }
}

#list-container {
    #search-button,
    #show-stats-button,
    #advanced-options-button {
        display: flex;
        padding: 0 $page-padding;
        gap: $icon-text-gap;
        align-items: center;
        height: 100%;
    
        &:hover {
            background-color: rgba(255, 255, 255, .1);
        }
    }
}

// Filters | Stats
    
#list-container .list-status-title {
    position: absolute;
    top: $list-toolbar-height * -1;
    right: 0;
    z-index: 2;
    
    .text {
        display: none;
    }
    
    .stats {
        display: flex;
    }
    
    #show-stats-button {
        order: 1;
    }
    
    #show-stats-button,
    #advanced-options-button {
        &:hover {
            background-color: rgba(255, 255, 255, .1);
        }
    }
}

#status-menu.fixed + .list-block .list-status-title {
    position: fixed;
    top: $header-height;
    right: max(0px, (100% - $content-max-width) / 2);
}

// Status dropdown

body.ownlist #list-container #status-menu .status-menu {
    &:hover {
        &:not(:has(.search-container:hover)) {
            height: 6 * $dropdown-item-height + 2 * $dropdown-padding;
        }
    }

    .status-button {
        border-radius: 0.375rem;
        padding-inline: $space-3;
        margin-inline: $space-3;
        display: flex;
        align-items: center;
        height: $dropdown-item-height;

        &.all_anime {
            margin-top: $dropdown-padding;
        }

        &.plantowatch {
            margin-bottom: $dropdown-padding;
        }

        &:hover {
            background-color: rgb(66, 66, 66);
        }
    }
}